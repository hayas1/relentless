name: example config of basic json compare test
destinations:
  actual: http://localhost:3000
  expect: http://localhost:3000
setting:
  http:
    evaluate:
      header: ignore

testcases:
  - target: /counter/increment
    setting:
      repeat: 10
    attr:
      allow: true
  - target: /health/rich
  - target: /information
    description: ignore datetime and hostname and uri
    setting:
      http:
        evaluate:
          body:
            json:
              ignore:
              - /datetime
              - /hostname
              - /headers/host
              - /uri
  - target: /information
    description: do not ignore datetime and hostname (must be failed, so attr allowed)
    attr:
      allow: true
  - target: /information
    description: patch datetime and hostname and uri
    setting:
      http:
        evaluate:
          body:
            json:
              patch:
              - {"op": "replace", "path": "/datetime", "value": "2024-10-10T00:00:00Z"}
              - {"op": "remove", "path": "/hostname"}
              - {"op": "remove", "path": "/uri"}
              - {"op": "replace", "path": "/headers/host", "value": "127.0.0.1:3000"}
              - {"op": "test", "path": "/path", "value": "/information"}
              patch-fail: allow
  - target: /information
    description: remove actual datetime only (must be failed, so attr allowed)
    setting:
      http:
        evaluate:
          body:
            json:
              patch:
                actual:
                - op: remove
                  path: /datetime
    attr:
      allow: true
